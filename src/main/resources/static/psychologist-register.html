<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Регистрация психолога - PsyConnect</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<nav class="navbar">
    <div class="container">
        <div class="logo">
            <i class="fas fa-brain"></i>
            <a href="index.html" style="color: inherit; text-decoration: none;">
                <span>PsyConnect</span>
            </a>
        </div>
        <div class="nav-links">
            <a href="login.html">Уже есть аккаунт?</a>
        </div>
    </div>
</nav>

<div class="container">
    <div class="form-container">
        <h1 class="form-title">Регистрация психолога</h1>

        <div class="registration-steps">
            <div class="step active">
                <div class="step-number">1</div>
                <div class="step-info">
                    <div class="step-title">Верификация телефона</div>
                    <div class="step-desc">Введите номер и получите код</div>
                </div>
            </div>
            <div class="step">
                <div class="step-number">2</div>
                <div class="step-info">
                    <div class="step-title">Заполнение профиля</div>
                    <div class="step-desc">Основная информация о вас</div>
                </div>
            </div>
            <div class="step">
                <div class="step-number">3</div>
                <div class="step-info">
                    <div class="step-title">Верификация</div>
                    <div class="step-desc">Проверка администратором</div>
                </div>
            </div>
        </div>

        <form id="psychologistForm" onsubmit="registerPsychologist(event)">
            <!-- Шаг 1: Верификация телефона -->
            <div id="step1" class="form-step active">
                <div class="form-group">
                    <label for="phone" class="form-label">Номер телефона *</label>
                    <input type="tel" id="phone" class="form-input" placeholder="+79991234567" required>
                    <div class="form-hint">На этот номер придет код подтверждения</div>
                </div>

                <div class="form-group">
                    <label for="otp" class="form-label">Код из SMS *</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="otp" class="form-input" placeholder="123456" maxlength="6" required>
                        <button type="button" class="btn btn-secondary" onclick="sendOTP()">
                            Получить код
                        </button>
                    </div>
                    <div class="form-hint">Введите 6-значный код из SMS</div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-primary" onclick="nextStep()">
                        Далее <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>

            <!-- Шаг 2: Заполнение профиля -->
            <div id="step2" class="form-step">
                <div class="form-group">
                    <label for="fullName" class="form-label">Полное имя *</label>
                    <input type="text" id="fullName" class="form-input" placeholder="Иванов Иван Иванович" required>
                </div>

                <div class="form-group">
                    <label for="email" class="form-label">Email *</label>
                    <input type="email" id="email" class="form-input" placeholder="ivanov@example.com" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="education" class="form-label">Образование</label>
                        <select id="education" class="form-input">
                            <option value="">Выберите образование</option>
                            <option value="bachelor">Бакалавриат</option>
                            <option value="master">Магистратура</option>
                            <option value="phd">Кандидат наук</option>
                            <option value="doctor">Доктор наук</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="specialization" class="form-label">Специализация</label>
                        <select id="specialization" class="form-input">
                            <option value="">Выберите специализацию</option>
                            <option value="clinical">Клиническая психология</option>
                            <option value="family">Семейная психология</option>
                            <option value="child">Детская психология</option>
                            <option value="corporate">Корпоративная психология</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="description" class="form-label">О себе</label>
                    <textarea id="description" class="form-input" rows="4" placeholder="Расскажите о своем опыте и подходе к работе..."></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" id="agreeTerms" required>
                        Я согласен с <a href="#">пользовательским соглашением</a> и <a href="#">этическим кодексом</a> *
                    </label>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="prevStep()">
                        <i class="fas fa-arrow-left"></i> Назад
                    </button>
                    <button type="submit" class="btn btn-primary">
                        Зарегистрироваться
                    </button>
                </div>
            </div>
        </form>

        <div class="form-footer">
            <p>Уже есть аккаунт? <a href="login.html">Войти</a></p>
        </div>
    </div>
</div>

<script src="script.js"></script>
<script>
    let currentStep = 1;

    function nextStep() {
        // Валидация шага 1
        const phone = document.getElementById('phone').value;
        const otp = document.getElementById('otp').value;

        if (!phone || !validatePhone(phone)) {
            showStatus('Введите корректный номер телефона', 'error');
            return;
        }

        if (!otp || otp.length !== 6) {
            showStatus('Введите 6-значный код из SMS', 'error');
            return;
        }

        // Переход к шагу 2
        document.getElementById('step1').classList.remove('active');
        document.getElementById('step2').classList.add('active');

        // Обновить индикатор шагов
        document.querySelectorAll('.registration-steps .step')[0].classList.remove('active');
        document.querySelectorAll('.registration-steps .step')[1].classList.add('active');

        currentStep = 2;
    }

    function prevStep() {
        // Вернуться к шагу 1
        document.getElementById('step2').classList.remove('active');
        document.getElementById('step1').classList.add('active');

        // Обновить индикатор шагов
        document.querySelectorAll('.registration-steps .step')[1].classList.remove('active');
        document.querySelectorAll('.registration-steps .step')[0].classList.add('active');

        currentStep = 1;
    }

    async function sendOTP() {
        const phone = document.getElementById('phone').value;

        if (!phone || !validatePhone(phone)) {
            showStatus('Введите корректный номер телефона', 'error');
            return;
        }

        showStatus('Отправляем код...', 'info');

        // Заглушка для API
        setTimeout(() => {
            showStatus(`Код отправлен на ${phone}. Для теста используйте: 123456`, 'success');
        }, 1000);
    }

    async function registerPsychologist(event) {
        event.preventDefault();

        const phone = document.getElementById('phone').value;
        const otp = document.getElementById('otp').value;
        const fullName = document.getElementById('fullName').value;
        const email = document.getElementById('email').value;
        const education = document.getElementById('education').value;
        const specialization = document.getElementById('specialization').value;
        const description = document.getElementById('description').value;

        // Валидация
        if (!fullName || !email) {
            showStatus('Заполните все обязательные поля', 'error');
            return;
        }

        if (!validateEmail(email)) {
            showStatus('Введите корректный email', 'error');
            return;
        }

        showStatus('Регистрируем психолога...', 'info');

        // Заглушка для API
        setTimeout(() => {
            showStatus('Регистрация успешна! Ваш профиль отправлен на верификацию администратору.', 'success');

            // Сохранить данные пользователя (заглушка)
            const mockUser = {
                id: 1,
                phone: phone,
                userRole: 'ROLE_PSYCHOLOGIST',
                fullName: fullName,
                email: email,
                verified: false
            };

            localStorage.setItem('currentUser', JSON.stringify(mockUser));
            localStorage.setItem('accessToken', 'mock_token');

            // Перенаправить в ЛК через 2 секунды
            setTimeout(() => {
                window.location.href = 'psychologist-dashboard.html';
            }, 2000);
        }, 1500);
    }
</script>

<style>
    .registration-steps {
        display: flex;
        justify-content: space-between;
        margin-bottom: 40px;
        position: relative;
    }

    .registration-steps::before {
        content: '';
        position: absolute;
        top: 20px;
        left: 25px;
        right: 25px;
        height: 2px;
        background: var(--gray-300);
        z-index: 1;
    }

    .step {
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
        z-index: 2;
        flex: 1;
    }

    .step-number {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: var(--gray-300);
        color: var(--gray-600);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin-bottom: 10px;
        transition: all 0.3s;
    }

    .step.active .step-number {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        color: white;
    }

    .step-info {
        text-align: center;
    }

    .step-title {
        font-weight: 600;
        margin-bottom: 4px;
    }

    .step-desc {
        font-size: 14px;
        color: var(--gray-600);
    }

    .form-step {
        display: none;
    }

    .form-step.active {
        display: block;
    }

    .form-hint {
        font-size: 14px;
        color: var(--gray-600);
        margin-top: 6px;
    }

    .form-actions {
        display: flex;
        justify-content: space-between;
        margin-top: 30px;
    }

    @media (max-width: 768px) {
        .registration-steps {
            flex-direction: column;
            gap: 20px;
        }

        .registration-steps::before {
            display: none;
        }

        .step {
            flex-direction: row;
            gap: 15px;
            text-align: left;
        }

        .step-info {
            text-align: left;
        }
    }
</style>
</body>
</html>